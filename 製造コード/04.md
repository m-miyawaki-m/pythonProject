MyBatisのXML構造を解析して利用テーブルとカラムを特定する場合、以下の手順で進めるのが効果的です。コードを出力せずに要件定義を行う前提で、必要な情報を整理します。


---

1. 解析対象の特定

対象XMLファイルのリストアップ
MyBatisのMapper XMLファイルをすべてリストアップします。

対象SQLタグの特定
以下のタグを対象にします：

<select>, <insert>, <update>, <delete>

<sql>（共通SQL）

<include>（外部SQLのインクルード）




---

2. SQL文の解析

静的SQL
SQL文を直接記載している場合、from句やjoin句を解析して使用テーブルを特定します。

例：SELECT col1, col2 FROM table_name

利用テーブル：table_name

利用カラム：col1, col2



動的SQL
動的タグ（例：<if>, <choose>, <foreach>）を解析し、どの条件でどのテーブル・カラムが使われるかを整理します。



---

3. WHERE句の条件解析

Java側から渡されるパラメータの特定
parameterTypeや#{paramName}の記載から、Java側から渡される変数を抽出します。

例：WHERE col1 = #{param1}
→ パラメータ：param1
→ 利用カラム：col1


動的条件
<if>や<where>で条件が付加される場合、条件によって利用されるカラムを整理します。



---

4. 外部SQLの解析

<include>タグの展開
<include refid="sqlId">を使用している場合、参照先のSQLを解析して利用テーブル・カラムを取得します。

<sql>タグの内容確認
<sql>タグに記載された共通部分（例：カラムリスト、WHERE条件）を抽出します。



---

5. まとめるべき内容

要件定義として、以下を整理します：

1. 利用テーブル一覧

各SQLで利用されるテーブルのリスト



2. 利用カラム一覧

各SQL文で使用されるカラムのリスト（SELECT句、WHERE句）



3. 条件式に関連するパラメータ一覧

Java側から渡されるパラメータ（#{}形式）とそれが影響を与えるカラムや条件





---

6. 補足（必要に応じて考慮するポイント）

SQLの結合やサブクエリ

JOINで関連するテーブルや、サブクエリ内の利用カラムも漏れなく整理する。


変更点の管理

動的条件や共通SQLを含む場合、将来的な変更の影響範囲を明確にしておく。




---

この手順を実行することで、XMLファイルからどのテーブルやカラムが利用されているかを正確に把握でき、要件定義に基づく設計をスムーズに進められます。

