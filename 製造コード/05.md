MyBatisのXML構造解析においてタスクを分解するには、以下のステップで進めると効率的です。それぞれのタスクは独立して進められるように整理しています。


---

1. 準備タスク

1. 解析対象XMLファイルの特定

プロジェクト内のMapper XMLファイルをすべてリストアップする。

ファイル名やパスの一覧を作成する。



2. 解析範囲の決定

どのタグ（例：<select>だけか、<insert>なども含む）や範囲（すべてのSQL、特定モジュールだけなど）を解析するか決める。





---

2. 静的SQL解析

1. SQL文の抽出

<select>, <insert>, <update>, <delete>タグ内のSQL文を抽出する。

SQL文を整形して見やすくする（インデントや改行の統一）。



2. 利用テーブルの解析

FROM句やJOIN句から利用されるテーブル名を特定する。



3. 利用カラムの解析

SELECT句やWHERE句から使用されるカラム名を特定する。





---

3. 動的SQL解析

1. 動的条件の解析

<if>や<choose>タグ内で使用されている条件を確認する。

条件に関連するカラムやテーブルを抽出する。



2. 繰り返し構造の解析

<foreach>タグ内で繰り返し処理されるカラムや条件を解析する。





---

4. 外部SQLの展開

1. <include>タグの解析

<include>タグのrefidで参照しているSQLを展開し、利用されるテーブル・カラムを特定する。



2. <sql>タグの解析

<sql>タグに記載された共通部分を展開して、各SQLに追加される内容を把握する。





---

5. Java側パラメータの解析

1. パラメータの抽出

parameterTypeの記載から、Javaクラスや渡されるパラメータ名を特定する。

SQL内の#{}で記載されたパラメータ名を抽出する。



2. パラメータが影響する箇所の特定

WHERE句や動的条件で使用されているカラムや条件式を確認する。





---

6. 結果の整理

1. 利用テーブル一覧の作成

SQLごとに使用されるテーブル名を整理する。

重複するテーブルを統合して一覧を作成。



2. 利用カラム一覧の作成

SQLごとに使用されるカラム名を整理する。

重複するカラムを統合して一覧を作成。



3. パラメータ一覧の作成

Java側パラメータ名と、関連する条件式やカラムのリストを作成する。





---

7. ドキュメント作成

1. 解析結果のレポート作成

利用テーブル・カラム一覧、パラメータ一覧をドキュメントにまとめる。

必要に応じて、テーブルごとの利用頻度や、動的条件の一覧も追記する。



2. 要件定義としての利用

要件定義で必要な情報が揃っているか確認し、他のチームと共有する。





---

タスクの優先度設定

優先度高：

静的SQLの解析

利用テーブル・カラムの抽出


優先度中：

動的SQLの解析

Javaパラメータの影響箇所確認


優先度低：

外部SQLの展開（共通部分の詳細分析）




---

このタスク分解により、各ステップを分担できるようになるため、効率的に進められます。また、進捗管理も容易になるでしょう。

