ご指摘の通り、タスクとして**解析基盤の後に CSV を結合して完全な CRUD 図を作成**する処理が必要になります。また、**CI/CD パイプライン後にも再度出力と整合性確認を行う**ステップが追加されます。

以下のようにタスクを再構成し、正確な流れを反映します。

---

## **タスクの再構成**

| **カテゴリ**           | **タスク名**                          | **担当範囲**                         | **成果物**                        |
| ---------------------- | ------------------------------------- | ------------------------------------ | --------------------------------- |
| **解析基盤**           | Java コード解析ツールの実装           | Java クラスの Logic/DAO 解析         | CSV 出力（Java 側 CRUD 情報）     |
|                        | MyBatis XML 解析ツールの実装          | XML ファイルの SQL・CRUD 解析        | CSV 出力（MyBatis 側 CRUD 情報）  |
| **CRUD 図結合**        | Java 側・XML 側の CSV 結合処理        | 解析結果を統合し、完全な CRUD 図作成 | 完全な CRUD 図（初期 CSV）        |
| **差分管理**           | Git 差分抽出スクリプトの実装          | 変更ファイルを取得（Git 操作）       | 差分ファイルリスト                |
|                        | 差分ファイルの CRUD 部分更新ロジック  | 差分ファイルの解析・マージ処理       | 更新された CRUD 図（CSV）         |
| **CI/CD パイプライン** | 差分解析の CI/CD ジョブの作成         | コミットごとに差分解析               | 差分 CRUD 図更新                  |
|                        | 完全解析の CI/CD ジョブの作成         | 週末に完全解析をスケジュール実行     | 完全 CRUD 図再生成                |
| **出力と整合性**       | CRUD 図マージと整合性確認（初回作成） | CSV 結合結果の確認と初期 CRUD 図生成 | 初期完全 CRUD 図（CSV/EA 用 XML） |
|                        | 差分解析後の CRUD 図整合性確認        | CI/CD 後の結果確認・統合             | 最新 CRUD 図（CSV/EA 用 XML）     |
|                        | エラーハンドリング・ログ出力          | 異常時の処理・ログ記録               | エラーレポート・ログ              |

---

## **流れの整理**

### **フェーズ 1: 解析基盤の開発**

1. **Java コード解析** → Logic/DAO から MyBatis 呼び出しを解析し、CSV 出力。
2. **MyBatis XML 解析** → XML を解析し、SQL 情報を抽出し、CSV 出力。

### **フェーズ 2: CRUD 図の作成**

1. **Java 側と XML 側の CSV を結合**：
   - Namespace と ID をキーにデータをマッチングし、完全な CRUD 図（初期版）を生成。
2. **出力と整合性確認**：
   - 初回作成時に重複やデータ不整合がないかを確認し、結果をエクスポート。

---

### **フェーズ 3: 差分管理**

1. **Git 差分抽出** → 変更された Java・XML ファイルをリストアップ。
2. **差分解析** → 差分ファイルに対して CRUD 図部分更新処理を実行。
3. **部分 CRUD 図更新** → 最新 CRUD 図に差分解析結果をマージ。

---

### **フェーズ 4: CI/CD パイプライン**

1. **差分解析ジョブ** → コミットごとに差分ファイルを対象に CRUD 図を部分更新。
2. **完全解析ジョブ** → 週末に全ファイルを対象に完全解析を実行し、CRUD 図をリフレッシュ。
3. **CRUD 図整合性確認** → CI/CD 後、最新 CRUD 図の整合性を確認し出力。

---

### **フェーズ 5: 出力と最終整合性**

1. **CRUD 図の整合性確認**：
   - 差分解析と完全解析の結果が正確に反映されているか最終確認。
2. **成果物出力**：
   - CSV ファイル、EA 用 XML 形式など、CRUD 図を成果物として出力。
3. **エラーハンドリング・ログ確認**：
   - 異常やエラーがないかログ出力を確認し、最終的な品質を担保。

---

## **スケジュールと依存関係**

### **フェーズ 1〜2: 基盤開発と初期 CRUD 図作成**

- 解析ツールと CRUD 図結合処理を同時並行で実装。

### **フェーズ 3: 差分管理の実装**

- CRUD 部分更新を実装し、初回 CRUD 図をベースに差分を反映。

### **フェーズ 4: CI/CD パイプライン**

- 差分解析と完全解析を CI/CD パイプラインに統合。

### **フェーズ 5: 整合性確認と成果物出力**

- 各フェーズの完了後に CRUD 図の整合性を確認し、エクスポート。

---

## **まとめ**

- **解析基盤** → **CRUD 図結合** → **差分管理** → **CI/CD** → **整合性確認** という流れを明確に切り分けました。
- CI/CD パイプライン実行後にも整合性確認のタスクを挟むことで、CRUD 図の品質を担保します。
- 最終的な成果物（CRUD 図）をクリーンに保ちながら運用できます。
